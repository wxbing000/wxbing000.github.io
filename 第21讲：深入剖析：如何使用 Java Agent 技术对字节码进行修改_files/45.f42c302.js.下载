(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{1162:function(e,t,i){"use strict";i.r(t);var a=i(2485);for(var s in a)["default"].indexOf(s)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(s);var r=i(3260),n=i.n(r),o=i(3261),u=i(59);var l=function(e){i(3259)},d=Object(u.a)(n.a,o.a,o.b,!1,l,"data-v-8a71eb10",null);t.default=d.exports},2485:function(e,t,i){"use strict";var a=i(45);i(21)(t,"__esModule",{value:!0}),t.default=void 0;var s=a(i(21)),r=a(i(454)),n=a(i(455)),o=a(i(176)),u=a(i(456)),l=a(i(453)),d=a(i(420)),y=a(i(513)),c=a(i(405)),p=a(i(432)),h=a(i(423)),f=i(409),m=a(i(2486)),P=i(551),v=i(461),I=i(1541);function g(e,t){var i=(0,l.default)(e);if(u.default){var a=(0,u.default)(e);t&&(a=a.filter((function(t){return(0,o.default)(e,t).enumerable}))),i.push.apply(i,a)}return i}function S(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?g(Object(i),!0).forEach((function(t){(0,h.default)(e,t,i[t])})):n.default?(0,r.default)(e,(0,n.default)(i)):g(Object(i)).forEach((function(t){(0,s.default)(e,t,(0,o.default)(i,t))}))}return e}var T={data:function(){return{player:null,uploadPlayInfo:!1,initTime:0,isReportHeart:!0}},computed:S(S({},(0,f.mapGetters)(["playerStatus","playerRate","isFirstPlay","playerSecondCurrentTime","slideSetTime","currentCourseLessons","isPlayerReady","currentEnv","appVersion","isNativeAudioPlay","isPlayingBeforeBack"])),{},{getBasicInfo:function(){return{userId:window.userInfo&&window.userInfo.id||"",currentEnvironment:this.currentEnv,browserName:v.browserName||"",OSName:v.OSName,browserVersion:v.fullVersion||"",appVersion:this.appVersion||"",courseId:this.currentCourseLessons.courseId,lessonId:this.currentCourseLessons.id}}}),watch:{playerStatus:function(e,t){if(!this.isNativeAudioPlay){var i=this.playerStatus,a=i.id,s=i.audioMediaDTO,r=void 0===s?{}:s;!this.player&&e.isPlaying||this.player&&a!==t.id?this.initAudio(!0):this.player&&(e.isPlaying?(this.player.currentTime=this.playerSecondCurrentTime,r&&this.player.currentTime>=r.durationNum?this.initAudio(!0):this.player.play()):this.player.pause())}},playerRate:function(e){this.player.playbackRate=e},slideSetTime:function(e){this.player.currentTime=(0,p.default)(e)}},created:function(){if(this.isNativeAudioPlay){var e=this;window.lgBridge&&window.lgBridge.response("LgAudioPlayStatus",(function(t,i,a){if(t&&t.lessonId&&t.courseId===window.courseInfo.id){var s=1===t.playStatus;e.setLessonPlayer({id:t.lessonId,isPlaying:s,isNativeNotify:!0}),i({success:!0})}}))}},mounted:function(){document.addEventListener("visibilitychange",this.autoPlayOrPause)},destroyed:function(){document.removeEventListener("visibilitychange",this.autoPlayOrPause),this.setIsReportHeart(!1),this.isReportHeart=!0},methods:S(S({},(0,f.mapActions)(["setPlayerAllTime","setFormatPlayerCurrentTime","setPlayerIsReady","setLessonPlayer","setIsPlayerFirstLoaded","reportLessonHeart","setIsReportHeart","setLessonLearned","savePlayerBackStatus"])),{},{autoPlayOrPause:function(){if(!this.isNativeAudioPlay&&!this.isPc){var e=this.playerStatus,t=e.id,i=e.isPlaying;if(t){var a,s=document.visibilityState;"hidden"===s?(this.savePlayerBackStatus(i),a=!1):"visible"===s&&this.isPlayingBeforeBack&&(a=!0),"boolean"===typeof a&&this.setLessonPlayer({id:t,isPlaying:a})}}},timeUpdate:function(e){var t=this;this.setFormatPlayerCurrentTime(e.target.currentTime),this.isLogin&&!this.uploadPlayInfo&&(this.uploadPlayInfo=setTimeout((function(){t.updateCourseLessonsHistory(e.target.currentTime,!0),clearTimeout(t.uploadPlayInfo),t.uploadPlayInfo=!1}),1e4)),this.isLogin&&this.isReportHeart&&(this.isReportHeart=!1,this.setIsReportHeart(!0),setTimeout((function(){t.isReportHeart=!0}),61e3))},pause:function(e){this.setIsReportHeart(!1),this.isReportHeart=!0,this.setLessonPlayer({id:this.playerStatus.id,isPlaying:!1})},canplay:function(){!this.playerStatus.isSliderChange&&this.initTime&&(this.player.currentTime=this.initTime,this.initTime=0),this.setPlayerIsReady(!0),this.setIsPlayerFirstLoaded(!0)},waiting:function(){this.setPlayerIsReady(!1)},play:function(){(0,I.reportPlayInfo)((0,c.default)(this.getBasicInfo,{playInfo:(0,y.default)({isError:!1,error:""})}))},error:function(e){var t=document.getElementById("video");t&&(0,I.reportPlayInfo)((0,c.default)(this.getBasicInfo,{playInfo:(0,y.default)({isError:!0,error:{code:t.error&&t.error.code||"",msg:(0,y.default)(t.error)||"",htmlPlayerErrorType:"",htmlPlayerErrorDetails:"",htmlPlayerErrorFrag:""}})}))},ended:function(){this.setLessonPlayer({id:this.playerStatus.id,isPlaying:!1}),clearTimeout(this.uploadPlayInfo),this.uploadPlayInfo=!1,this.updateCourseLessonsHistory(this.playerStatus.audioMediaDTO.durationNum,!0),this.setIsReportHeart(!1),this.isReportHeart=!0},updateCourseLessonsHistory:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1?arguments[1]:void 0;if(this.isLogin){var a=this.playerStatus,s=a.courseId,r=a.sectionId,n=a.id,o=a.hasLearned,u=i?(0,d.default)("".concat(t),10):0,l={courseId:s,sectionId:r,lessonId:n,historyNode:u,mediaType:0};(0,P.fetchSaveHistory)(l).then((function(){o||e.setLessonLearned({sectionId:r,lessonId:n})}))}},initAudio:function(e){var t=this.playerStatus&&this.playerStatus.audioMediaDTO&&this.playerStatus.audioMediaDTO.fileUrl||"",i=document.getElementById("video");if(m.default.isSupported()){var a=new m.default;a.loadSource(t),a.attachMedia(i),this.player=i}else i.canPlayType("application/vnd.apple.mpegurl")&&(i.src=t,this.player=i);this.playerStatus.isSliderChange||this.getLessonPlayHistory(),e&&this.player.play()},getLessonPlayHistory:function(){var e=this;(0,P.fetchLessonPlayHistory)({lessonId:this.playerStatus.id||""}).then((function(t){if(1===t.state){var i=t.content.historyNode,a=void 0===i?0:i,s=e.playerStatus.audioMediaDTO;s&&a>=s.durationNum&&(a=0),e.initTime=a,e.player.currentTime=a}}))}})};t.default=T},3259:function(e,t,i){},3260:function(e,t,i){"use strict";var a=i(45);i(21)(t,"__esModule",{value:!0}),t.default=void 0;var s=a(i(21)),r=a(i(454)),n=a(i(455)),o=a(i(176)),u=a(i(456)),l=a(i(453)),d=a(i(420)),y=a(i(513)),c=a(i(405)),p=a(i(432)),h=a(i(423)),f=i(409),m=a(i(2486)),P=i(551),v=i(461),I=i(1541);function g(e,t){var i=(0,l.default)(e);if(u.default){var a=(0,u.default)(e);t&&(a=a.filter((function(t){return(0,o.default)(e,t).enumerable}))),i.push.apply(i,a)}return i}function S(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?g(Object(i),!0).forEach((function(t){(0,h.default)(e,t,i[t])})):n.default?(0,r.default)(e,(0,n.default)(i)):g(Object(i)).forEach((function(t){(0,s.default)(e,t,(0,o.default)(i,t))}))}return e}var T={data:function(){return{player:null,uploadPlayInfo:!1,initTime:0,isReportHeart:!0}},computed:S(S({},(0,f.mapGetters)(["playerStatus","playerRate","isFirstPlay","playerSecondCurrentTime","slideSetTime","currentCourseLessons","isPlayerReady","currentEnv","appVersion","isNativeAudioPlay","isPlayingBeforeBack"])),{},{getBasicInfo:function(){return{userId:window.userInfo&&window.userInfo.id||"",currentEnvironment:this.currentEnv,browserName:v.browserName||"",OSName:v.OSName,browserVersion:v.fullVersion||"",appVersion:this.appVersion||"",courseId:this.currentCourseLessons.courseId,lessonId:this.currentCourseLessons.id}}}),watch:{playerStatus:function(e,t){if(!this.isNativeAudioPlay){var i=this.playerStatus,a=i.id,s=i.audioMediaDTO,r=void 0===s?{}:s;!this.player&&e.isPlaying||this.player&&a!==t.id?this.initAudio(!0):this.player&&(e.isPlaying?(this.player.currentTime=this.playerSecondCurrentTime,r&&this.player.currentTime>=r.durationNum?this.initAudio(!0):this.player.play()):this.player.pause())}},playerRate:function(e){this.player.playbackRate=e},slideSetTime:function(e){this.player.currentTime=(0,p.default)(e)}},created:function(){if(this.isNativeAudioPlay){var e=this;window.lgBridge&&window.lgBridge.response("LgAudioPlayStatus",(function(t,i,a){if(t&&t.lessonId&&t.courseId===window.courseInfo.id){var s=1===t.playStatus;e.setLessonPlayer({id:t.lessonId,isPlaying:s,isNativeNotify:!0}),i({success:!0})}}))}},mounted:function(){document.addEventListener("visibilitychange",this.autoPlayOrPause)},destroyed:function(){document.removeEventListener("visibilitychange",this.autoPlayOrPause),this.setIsReportHeart(!1),this.isReportHeart=!0},methods:S(S({},(0,f.mapActions)(["setPlayerAllTime","setFormatPlayerCurrentTime","setPlayerIsReady","setLessonPlayer","setIsPlayerFirstLoaded","reportLessonHeart","setIsReportHeart","setLessonLearned","savePlayerBackStatus"])),{},{autoPlayOrPause:function(){if(!this.isNativeAudioPlay&&!this.isPc){var e=this.playerStatus,t=e.id,i=e.isPlaying;if(t){var a,s=document.visibilityState;"hidden"===s?(this.savePlayerBackStatus(i),a=!1):"visible"===s&&this.isPlayingBeforeBack&&(a=!0),"boolean"===typeof a&&this.setLessonPlayer({id:t,isPlaying:a})}}},timeUpdate:function(e){var t=this;this.setFormatPlayerCurrentTime(e.target.currentTime),this.isLogin&&!this.uploadPlayInfo&&(this.uploadPlayInfo=setTimeout((function(){t.updateCourseLessonsHistory(e.target.currentTime,!0),clearTimeout(t.uploadPlayInfo),t.uploadPlayInfo=!1}),1e4)),this.isLogin&&this.isReportHeart&&(this.isReportHeart=!1,this.setIsReportHeart(!0),setTimeout((function(){t.isReportHeart=!0}),61e3))},pause:function(e){this.setIsReportHeart(!1),this.isReportHeart=!0,this.setLessonPlayer({id:this.playerStatus.id,isPlaying:!1})},canplay:function(){!this.playerStatus.isSliderChange&&this.initTime&&(this.player.currentTime=this.initTime,this.initTime=0),this.setPlayerIsReady(!0),this.setIsPlayerFirstLoaded(!0)},waiting:function(){this.setPlayerIsReady(!1)},play:function(){(0,I.reportPlayInfo)((0,c.default)(this.getBasicInfo,{playInfo:(0,y.default)({isError:!1,error:""})}))},error:function(e){var t=document.getElementById("video");t&&(0,I.reportPlayInfo)((0,c.default)(this.getBasicInfo,{playInfo:(0,y.default)({isError:!0,error:{code:t.error&&t.error.code||"",msg:(0,y.default)(t.error)||"",htmlPlayerErrorType:"",htmlPlayerErrorDetails:"",htmlPlayerErrorFrag:""}})}))},ended:function(){this.setLessonPlayer({id:this.playerStatus.id,isPlaying:!1}),clearTimeout(this.uploadPlayInfo),this.uploadPlayInfo=!1,this.updateCourseLessonsHistory(this.playerStatus.audioMediaDTO.durationNum,!0),this.setIsReportHeart(!1),this.isReportHeart=!0},updateCourseLessonsHistory:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1?arguments[1]:void 0;if(this.isLogin){var a=this.playerStatus,s=a.courseId,r=a.sectionId,n=a.id,o=a.hasLearned,u=i?(0,d.default)("".concat(t),10):0,l={courseId:s,sectionId:r,lessonId:n,historyNode:u,mediaType:0};(0,P.fetchSaveHistory)(l).then((function(){o||e.setLessonLearned({sectionId:r,lessonId:n})}))}},initAudio:function(e){var t=this.playerStatus&&this.playerStatus.audioMediaDTO&&this.playerStatus.audioMediaDTO.fileUrl||"",i=document.getElementById("video");if(m.default.isSupported()){var a=new m.default;a.loadSource(t),a.attachMedia(i),this.player=i}else i.canPlayType("application/vnd.apple.mpegurl")&&(i.src=t,this.player=i);this.playerStatus.isSliderChange||this.getLessonPlayHistory(),e&&this.player.play()},getLessonPlayHistory:function(){var e=this;(0,P.fetchLessonPlayHistory)({lessonId:this.playerStatus.id||""}).then((function(t){if(1===t.state){var i=t.content.historyNode,a=void 0===i?0:i,s=e.playerStatus.audioMediaDTO;s&&a>=s.durationNum&&(a=0),e.initTime=a,e.player.currentTime=a}}))}})};t.default=T},3261:function(e,t,i){"use strict";i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return s}));var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("video",{staticClass:"video vjs-default-skin",attrs:{id:"video",controls:"controls","x-webkit-airplay":"true","x5-video-player-fullscreen":"true",preload:"auto",playsinline:"true","webkit-playsinline":"","x5-video-player-type":"h5"},on:{timeupdate:e.timeUpdate,pause:e.pause,canplay:e.canplay,play:e.play,error:e.error,ended:e.ended,waiting:e.waiting}},[i("source",{attrs:{type:"application/x-mpegURL",src:e.playerStatus&&e.playerStatus.audioMediaDTO&&e.playerStatus.audioMediaDTO.fileUrl||""}})])},s=[]}}]);
//# sourceMappingURL=45.f42c302.js.map